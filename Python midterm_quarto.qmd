# Python Midterm {.unnumbered}

20249132 ê¹€í˜•í™˜

## Problem 1.

![](images/Python_midterm1.png)

### (1)
5ê°œì˜ ì¸ì facevalue=ğ‘ƒğ‘‰, couprate=ğ‘Ÿ, yield=ğ‘¦, maturity=ğ‘€ìœ¼ë¡œ ì…ë ¥í•˜ê³ , frequency=ğ‘“ì— ë§ê²Œ â€œannualâ€, â€œsemi-annualâ€, â€œquarterlyâ€ ì¤‘ í•˜ë‚˜ì˜ ë¬¸ì ê°’ìœ¼ë¡œ ì…ë ¥í•˜ë©´, ìœ„ ì‹ì— ë”°ë¼ ê³„ì‚°ëœ ì±„ê¶Œê°€ê²©ê³¼ ë“€ë ˆì´ì…˜ì„ ì•„ë˜ì™€ ê°™ì€ í˜•íƒœì˜ íŠœí”Œë¡œ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ bondftnì„ ì‘ì„±í•˜ì—¬ë¼.


```python
def bondftn(pv,r,y,m,f="annual",rnd=3):
    if type(pv)!=float and type(pv)!=int : return print("error: pv should be number!!!")
    if type(r)!=float and type(r)!=int: return print("error: r should be number!!!")
    if type(y)!=float and type(y)!=int: return print("error: y should be number!!!")
    if type(m)!=int: return print("error: M should be integer!!!")
    if f=="annual": fre=1
    elif f=="semi-annual": fre=2
    elif f=="quarterly": fre=4
    else: return print("error: f can be 'annual', 'semi-annual', 'quarterly'")
    n=fre*m
    coupon=pv*r/100/fre
    price=0.0
    value_duration=0.0
    for i in range(n):
        if i==n-1: cf_i=pv+coupon
        else: cf_i=coupon
        pv_cf_i=cf_i/((1+(y/100/fre))**(i+1))
        tw_pv_cf_i=((i+1)/fre)*cf_i/(1+(y/100/fre))**(i+1)
        price+=pv_cf_i
        value_duration+=tw_pv_cf_i
    duration=value_duration/price
    result=(round(price,rnd),round(duration,rnd))
    return result
```


```python
bondftn(pv=100,r=5,y=4.5,m=2,f="quarterly")
```




    (100.951, 1.916)



### (2)

ë§Œê¸° Mì´ 5, 4, 3, 2, 1ì¸ ê° ê²½ìš°ì— ëŒ€í•´, ì¿ í°ì´ììœ¨ì´ 5%, 4%, 3%, 2%, 1% ì¸ ê°ê°ì— ëŒ€í•˜ì—¬ ë§Œê¸°ìˆ˜ìµë¥ ì´ 10%ì— 11%ë¡œ ìƒìŠ¹í•¨ì— ë”°ë¼ ì±„ê¶Œ ê°€ê²©ì˜ ë³€í™”ìœ¨ì´ ëª‡ %ì¸ì§€ë¥¼ ëª¨ë‘
ê³„ì‚°í•œ ë’¤, ì•„ë˜ì™€ ê°™ì€ ì¤‘ì²©ëœ ë”•ì…”ë„ˆë¦¬ result_dictìœ¼ë¡œ ì €ì¥í•˜ì—¬ë¼.

ë‹¨, ì•¡ë©´ê°€ëŠ” 100, ì¿ í° ì§€ê¸‰ íšŸìˆ˜ëŠ” ì—°ê°„ 1íšŒë¼ê³  í•˜ì.



```python
result_dict=dict()
for i in range(5):
    m_i=5-i
    result_dict['M='+str(m_i)]=dict()
    for j in range(5):
        r_j=5-j
        price_before=bondftn(pv=100,r=r_j,y=10,m=m_i,f="annual")[0]
        price_after=bondftn(pv=100,r=r_j,y=11,m=m_i,f="annual")[0]
        price_return=(price_after-price_before)/price_before
        result_dict['M='+str(m_i)][str(r_j)+'%']=round(price_return,5)
result_dict
```




    {'M=5': {'5%': -0.03974,
      '4%': -0.04046,
      '3%': -0.04126,
      '2%': -0.04215,
      '1%': -0.04314},
     'M=4': {'5%': -0.03287,
      '4%': -0.03332,
      '3%': -0.03381,
      '2%': -0.03434,
      '1%': -0.03491},
     'M=3': {'5%': -0.02544,
      '4%': -0.02568,
      '3%': -0.02593,
      '2%': -0.02619,
      '1%': -0.02648},
     'M=2': {'5%': -0.01749,
      '4%': -0.01758,
      '3%': -0.01765,
      '2%': -0.01776,
      '1%': -0.01784},
     'M=1': {'5%': -0.00901,
      '4%': -0.009,
      '3%': -0.009,
      '2%': -0.009,
      '1%': -0.00901}}




```python
result_dict['M=5']['5%']
```




    -0.03974



### (3)
ë§Œê¸° Mì´ 5, 4, 3, 2, 1ì¸ ê° ê²½ìš°ì— ëŒ€í•´, ì¿ í°ì´ììœ¨ì´ 5%, 4%, 3%, 2%, 1% ì¸ ê°ê°ì— ëŒ€í•˜ì—¬ ë§Œê¸°ìˆ˜ìµë¥ ì´ 10%ë¡œ ì£¼ì–´ì¡Œì„ ë•Œì˜ ë“€ë ˆì´ì…˜ì„ (1)ì—ì„œì˜ bondftnì„ í™œìš©í•˜ì—¬ ëª¨ë‘
ê³„ì‚°í•˜ì—¬ë¼.

ë˜í•œ ì´ë¥¼ (2)ì—ì„œì™€ ë™ì¼í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” (ì¤‘ì²©ëœ) ë”•ì…”ë„ˆë¦¬ result_dict_durì— ì €ì¥í•˜ì—¬ë¼.

ì¦‰ ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ê°’ì„ ì¶”ì¶œí•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ë‹¨, ì—¬ê¸°ì„œë„ ì•¡ë©´ê°€ëŠ” 100, ì¿ í° ì§€ê¸‰ íšŸìˆ˜ëŠ” ì—°ê°„ 1íšŒë¼ê³  í•˜ì.


```python
result_dict_dur=dict()
for i in range(5):
    m_i=5-i
    result_dict_dur['M='+str(m_i)]=dict()
    for j in range(5):
        r_j=5-j
        result_dict_dur['M='+str(m_i)][str(r_j)+'%']=bondftn(pv=100,r=r_j,
                                                             y=10,m=m_i,
                                                             f="annual",rnd=5)[1]
result_dict_dur
```




    {'M=5': {'5%': 4.48786,
      '4%': 4.57019,
      '3%': 4.66101,
      '2%': 4.76171,
      '1%': 4.874},
     'M=4': {'5%': 3.6951,
      '4%': 3.74653,
      '3%': 3.80216,
      '2%': 3.8625,
      '1%': 3.9282},
     'M=3': {'5%': 2.84899,
      '4%': 2.87566,
      '3%': 2.90394,
      '2%': 2.93397,
      '1%': 2.96593},
     'M=2': {'5%': 1.95023,
      '4%': 1.95941,
      '3%': 1.96896,
      '2%': 1.97889,
      '1%': 1.98923},
     'M=1': {'5%': 1.0, '4%': 1.0, '3%': 1.0, '2%': 1.0, '1%': 1.0}}




```python
result_dict_dur['M=5']['4%']
```




    4.57019



## Problem 2.

![](images/Python_midterm2.png)

### (1) 
ì–´ë–¤ 1ë…„ ë™ì•ˆ ë°œìƒí•˜ëŠ” ëª¨ë“  ì²­êµ¬ë“¤ì˜ ì‹œê°„ê³¼ ê¸ˆì•¡ì„ ëª¨ì˜ì‹¤í—˜í•´ ë³´ì.

0ì—ì„œ ì‹œì‘í•˜ì—¬1ë…„ ë™ì•ˆ ë³´í—˜íšŒì‚¬ì˜ ì”ê³ ë¥¼ ê³„ì‚°í•œ ë’¤ balanceë¼ëŠ” ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•˜ì—¬ë¼.

ë‹¨, balanceì˜ ì²«ë²ˆì§¸ ê°’ì€ 0ì´ë©°, ë³´í—˜ ì²­êµ¬ê°€ ë°œìƒí•˜ëŠ” ì‹œì (ğ‘¡)ì—ë§Œ, í•´ë‹¹ ì‹œì ì˜ balance (ê·¸ ì‹œì ê¹Œì§€ ë°›ì€ ë³´í—˜ë£Œ ìˆ˜ìµ(150ğ‘¡)ì„ ë”í•˜ê³ , ê·¸ ì‹œì ì—ì„œ ì²­êµ¬ë¡œ ì§€ê¸‰ë˜ëŠ” ë³´í—˜ê¸ˆì„ ë¹¼ ì£¼ëŠ” ë°©ì‹)ë¥¼ ê³„ì‚°í•˜ì—¬ ìˆœì„œëŒ€ë¡œ ì €ì¥í•  ê²ƒ.

**Answer**

ë¨¼ì €, ë³´í—˜ê¸ˆì˜ ì—°ê°„ ì²­êµ¬ê±´ìˆ˜ê°€ í‰ê· ì´ 100ì¸ í¬ì•„ì†¡ë¶„í¬ë¥¼ ë”°ë¥´ë¯€ë¡œ $pmf,\;P(X=x)=\frac{\lambda^xe^{-\lambda}}{x!},\;\lambda=100$ì…ë‹ˆë‹¤.

ë‹¤ìŒìœ¼ë¡œ, ë³´í—˜ê¸ˆì˜ ì²­êµ¬ê¸ˆì•¡ì€ í‰ê· ì€ 1, ë¶„ì‚°ì€ 1/2ì¸ ê°ë§ˆë¶„í¬ë¥¼ ë”°ë¥´ë¯€ë¡œ $pdf,\;f(x)=x^{k-1}\frac{e^{-x/\theta}}{\theta^k\Gamma(k)},\;k\theta=1,\;k\theta^2=1/2$ì…ë‹ˆë‹¤. ì¦‰, $k=2,\;\theta=1/2$ì…ë‹ˆë‹¤.

ê° ì²­êµ¬ê¸ˆì•¡ì€ ì¦‰ì‹œ ì§€ê¸‰ë˜ë©°, ë°œìƒì‹œì ì€ 0~1 ì‚¬ì´ì˜ uniform distributionì„ ë”°ë¥´ë¯€ë¡œ $pdx.\;f(x)=\frac{1}{1-0}=1$ì…ë‹ˆë‹¤.

ì´ì œ, 1ë…„ê°„ ë°œìƒí•˜ëŠ” ë³´í—˜ì†ìµì˜ ëª¨ì˜ì‹¤í—˜ì— ëŒ€í•œ ì²­êµ¬ê±´ìˆ˜(í¬ì•„ì†¡ë¶„í¬)ë¥¼ $N$ë²ˆì´ë¼ê³  í•˜ê³ , ì²­êµ¬ê¸ˆì•¡(ê°ë§ˆë¶„í¬) ë° ì²­êµ¬ì‹œì (ê· ë“±ë¶„í¬)ë¥¼ ê°ê° $g_i$ì™€ $t_i\; for\; 1,...,N$ë¼ê³  í•˜ë©´, $t=t_i$ ì‹œì ì˜ balanceëŠ” ì•„ë˜ì™€ ê°™ì´ ê³„ì‚°ë©ë‹ˆë‹¤.

$${balance}_{t_i}=150t_i-\sum_{k=1}^{i}g_k$$

ë˜í•œ, ê¸°ë§ì‹œì (t=1)ì˜ ìµœì¢… balanceëŠ” $150-\sum_{all\;k}g_k$ê°€ ë©ë‹ˆë‹¤.


```python
# í¬ì•„ì†¡, ê°ë§ˆ, ê· ë“±ë¶„í¬ì— ë‹¤í•œ ëª¨ì˜ì‹¤í—˜ì€ numpyì˜ random module í™œìš©
import numpy as np
from numpy import random as rd


rd.seed(0) # seedë¥¼ ì„¤ì •í•˜ì—¬ í†µì œ
N=rd.poisson(lam=100,size=1)
N=N[0]
t=rd.uniform(low=0.0,high=1.0,size=N)
t=np.sort(t)
g=rd.gamma(shape=2.,scale=0.5,size=N)
balance=[0] # balanceì˜ ì´ˆê¸°ê°’ì€ 0
for i in range(N):
    balance.append(round(t[i]*150-sum(g[:i+1]),4))
balance.append(round(150-sum(g),4)) # balanceì˜ ê¸°ë§ê°’
```


```python
print(balance[:5],balance[N-5:],sep="\n")
```

    [0, -1.9755, -2.1182, -2.7092, -3.9799]
    [44.5214, 47.2399, 48.4395, 48.2655, 47.6871, 48.74, 50.4839]


### (2)

ìœ„ ëª¨ì˜ì‹¤í—˜ì„ 10000íšŒ ë°˜ë³µí•˜ì—¬ ë‹¤ìŒì— ëŒ€í•œ í™•ë¥ ì„ ì¶”ì •í•´ ë³´ì.

- ë³´í—˜íšŒì‚¬ê°€ ìµœì¢…ì ìœ¼ë¡œ ê°€ì§€ê²Œ ë˜ëŠ” balanceì˜ ê¸°ëŒ€ê°’(ëª¨ì˜ì‹¤í—˜ì„ 10000íšŒ ë°˜ë³µí•˜ì˜€ì„ ë•Œ ê° ëª¨ì˜ì‹¤í—˜ë§ˆë‹¤ ê³„ì‚°ëœ balanceì˜ ìµœì¢…ê°’ë“¤ì˜ í‰ê· ìœ¼ë¡œ ì¶”ì •)ì€ ì–¼ë§ˆì¸ê°€?

- ë³´í—˜íšŒì‚¬ì˜ balanceê°€ 1ë…„ ì¤‘ í•œë²ˆ ì´ìƒ -5 ì´í•˜ë¡œ ë–¨ì–´ì§ˆ í™•ë¥ (10000íšŒì˜ ëª¨ì˜ì‹¤í—˜ ì¤‘ì—ì„œ balanceê°€ -5ì´í•˜ë¡œ ë–¨ì–´ì§„ ì ì´ ìˆì—ˆë˜ ê²½ìš°ì˜ ë¹„ìœ¨ë¡œ ì¶”ì •)ì€ ì–¼ë§ˆì¸ê°€?

**Answer**

í‰ê· ì€ ì•½ 49.86, -5ì´í•˜ë¡œ ë–¨ì–´ì§ˆ í™•ë¥ ì€ ì•½ 7.05\%ì…ë‹ˆë‹¤.


```python
last_balance=list()
minus5_balance=0
for k in range(10000):
    rd.seed(k)
    N=rd.poisson(lam=100,size=1)
    N=N[0]
    t=rd.uniform(low=0.0,high=1.0,size=N)
    t=np.sort(t)
    g=rd.gamma(shape=2.,scale=0.5,size=N)
    balance=[0]
    for i in range(N):
        balance.append(round(t[i]*150-sum(g[:i+1]),4))
    last_balance.append(round(150-sum(g),4))
    balance.sort()
    if balance[0]<=-5:minus5_balance+=1
print(sum(last_balance)/10000,
      minus5_balance/10000,sep="\n")
```

    49.864134890000095
    0.0705

