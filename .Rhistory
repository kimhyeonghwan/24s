weight[weight$grp=="F",]
weight$grp=="F"
weight$weight[weight$grp=="F"]
t.test(weight$weight[weight$grp=="F"]~weight$weight[weight$grp=="M"])
library(patchwork)
install.packages('patchwork')
library(patchwork)
ggplot(weight,aes(x='grp',y='weight'))+
geom_histogram()
floor(12)
floor(12,1)
round(54,2)
round(54,-2)
round(54,-1)
round(55,-1)
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1))
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1),cnt=1)
plot <- weight %>% group_by(group) %>% summarise(number=sum(cnt))
plot
plot <- weight %>% group_by(gender,group) %>% summarise(number=sum(cnt))
plot
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1.5),cnt=1)
weight
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight*2,-1)/2,cnt=1)
weight
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1),cnt=1)
plot <- weight %>% group_by(gender,group) %>% summarise(number=sum(cnt))
ggplot(plot,aes(x='group',y='number'))+
geom_histogram()
plot
ggplot(plot,aes(x=as.character('group'),y='number'))+
geom_histogram()
plot
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1),cnt=1)
plot <- weight %>% group_by(gender,group) %>% summarise(number=sum(cnt))
plot
ggplot(plot,aes(x=as.character('group'),y='number'))+
geom_point()
plot
ggplot(plot,aes(x='group'))+
geom_point()
ggplot(plot,aes(x='group'))+
geom_histogram()
ggplot(weight,aes(x='group'))+
geom_histogram()
weight
ggplot(weight,aes(x='group'))+
geom_histogram()
weight
ggplot(weight,aes(x='group'))+
geom_histogram()
ggplot(weight,aes(x='group'))+
geom_point()
weight
ggplot(weight,aes(x='weight'))+
geom_point()
ggplot(weight,aes(x='weight'))+
geom_histogram()
ggplot(weight,aes(x='weight'))+
geom_histogram()
ggplot(weight,aes(x='count'))+
geom_histogram()
weight
ggplot(weight %>% select(group),aes(x='group'))+
geom_histogram()
weight %>% select(group)
ggplot(weight,aes(x='group'))+
geom_histogram()
rm(list=ls())
library(tidyverse)
rm(list=ls())
library(tidyverse)
library(patchwork)
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106)) %>%
mutate(group=round(weight,-1),cnt=1)
ggplot(weight,aes(x='group'))+
geom_histogram()
weight
ggplot(weight,aes(x='weight'))+
geom_histogram()
ggplot(weight,aes(x='weight'))+
geom_density()
ggplot(weight,aes(x=weight,colour=gender)+
ggplot(weight,aes(x=weight,colour=gender))+
geom_density()
ggplot(weight,aes(x=weight,colour=gender))+
ggplot(weight,aes(x=weight,colour=gender))+
geom_density()
ggplot(weight,aes(x=weight,colour=gender))+
geom_density() +
theme_bw()
weight <- tibble(gender=c(rep("F",8),rep("M",11)),
weight=c(57,84,90,71,71,77,68,73,
71,93,101,84,88,117,86,86,93,86,106))
ggplot(weight,aes(x=weight,colour=gender))+
geom_density() +
theme_bw()
weight %>%
group_by(gender) %>%
mutate(cnt=1)
weight %>%
group_by(gender) %>%
mutate(cnt=1) %>%
summarise(sample=sum(cnt),mean=mean(weight),vol=sd(weight))
weight
t.test(weight~gender,data=weight,alternative="twe.sided",paired=F)
t.test(weight~gender,data=weight,alternative="two.sided",paired=F)
var.test(weight,gender,data=weight)
var.test(weight~gender,data=weight)
rm(list=ls())
library(tidyverse)
setwd("/Users/hwan/Desktop/Homepage/study_24spring")
getwd()
# problem5
pca <- read_csv("investment_hw/term_hw2.csv")
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
mutate(year=integer(observation_date))
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
mutate(year=as.integer(observation_date))
pca
View(pca)
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
mutate(year=as.character(observation_date))
View(pca)
# problem5
pca <- read_csv("investment_hw/term_hw2.csv")
pca
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate")
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(observation_date,maturity)
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date)
View(pca)
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate)) %>%
filter(observation_date==lag(observation_date), maturity==lag(maturity))
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate))
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate)) %>%
filter(maturity==lag(maturity))
View(pca)
pca %>% cov()
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate)) %>%
filter(maturity==lag(maturity)) %>%
mutate(date=observation_date) %>%
select(date,maturity,changes)
pca
pca %>% select(maturity,changes) %>% cov()
pca %>% pivot_wider(names_from = "maturity", values_from = "changes")
pca %>%
select(maturity,changes) %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca %>%
select(maturity,changes)
pca %>%
select(maturity,changes) %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes") %>%
cov()
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate)) %>%
filter(maturity==lag(maturity)) %>%
mutate(date=observation_date,
maturity=substr(maturity,5,nchar(maturity))) %>%
select(date,maturity,changes)
pca
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes") %>%
cov()
pca
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes") %>%
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=rate-lag(rate)) %>%
filter(maturity==lag(maturity)) %>%
mutate(date=observation_date,
maturity=substr(maturity,5,nchar(maturity)) %>% as.integer()) %>%
select(date,maturity,changes)
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
pca
pca %>% group_by(maturity) %>% cov()
pca %>% group_by(maturity) %>% cov(changes)
pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:]
cov_matrix <- cov_matrix[,2:2]
cov_matrix
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)]
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)]
cov_matrix
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)]
cov_matrix
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>% str_sort()
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>% str_sort()
cov_matrix
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>% str_sort(,numeric = TRUE)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>% str_sort(,numeric = TRUE)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)]
cov_matrix
str_sort(cov_matrix,numeric = TRUE)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(1:10)
cov_matrix
View(cov_matrix)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(1,2,3,4,5,7,10,30)
cov_matrix
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)]
View(cov_matrix)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(`1`,`2`,`3`,`4`,`5`,`7`,`10`,`30`)
cov_matrix
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(`1`,`2`,`3`,`4`,`5`,`7`,`10`,`30`) %>%
cov()
cov_matrix
View(cov_matrix)
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=(rate-lag(rate))*100) %>%
filter(maturity==lag(maturity)) %>%
mutate(date=observation_date,
maturity=substr(maturity,5,nchar(maturity)) %>% as.integer()) %>%
select(date,maturity,changes)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(`1`,`2`,`3`,`4`,`5`,`7`,`10`,`30`) %>%
cov()
cov_matrix
eigen(cov_matrix)
eigenstuff <- eigen(cov_matrix)
eigenstuff
eigenstuff <- eigen(cov_matrix) %>% tibble()
eigenstuff <- eigen(cov_matrix)
eigenstuff
eigenstuff <- eigen(cov_matrix)
eigenstuff$ratio=eigenstuff$values/sum(eigenstuff$values)
eigenstuff$ratio
eigenstuff$vectors[,1:3]
plot_pca <- tibble(maturity=c(1:8),
c(PC1,PC2,PC3)=eigenstuff$vectors[,1:3])
plot_pca <- tibble(maturity=c(1:8),
PC1=eigenstuff$vectors[,1:3])
plot_pca
plot_pca <- tibble(maturity=c(1:8),
PC1=eigenstuff$vectors[,1])
plot_pca
eigenstuff <- eigen(cov_matrix)
eigenstuff$ratio=eigenstuff$values/sum(eigenstuff$values)
eigenstuff$vectors
plot_pca <- tibble(maturity=c(1:8),
PC1=eigenstuff$vectors[,1],
PC2=eigenstuff$vectors[,2],
PC3=eigenstuff$vectors[,3]) %>%
pivot_longer(cols=contains("PC"),names_to = "components", values_to = "values")
plot_pca <- tibble(maturity=c(1:8),
PC1=eigenstuff$vectors[,1],
PC2=eigenstuff$vectors[,2],
PC3=eigenstuff$vectors[,3]) %>%
pivot_longer(cols=contains("PC"),names_to = "components", values_to = "values") %>%
ggplot(.,aes(x=maturity,y=values,colour=components))+
geom_line(size=1)
plot_pca
plot_pca <- tibble(maturity=c(1:8),
PC1=eigenstuff$vectors[,1],
PC2=eigenstuff$vectors[,2],
PC3=eigenstuff$vectors[,3]) %>%
pivot_longer(cols=contains("PC"),names_to = "components", values_to = "values") %>%
ggplot(.,aes(x=maturity,y=values,colour=components))+
geom_line(size=1)+
theme_bw()
plot_pca
pca
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(`1`,`2`,`3`,`4`,`5`,`7`,`10`,`30`) %>%
cov() %>%
tibble()
cov_matrix
pca
# problem5
pca <- read_csv("investment_hw/term_hw2.csv") %>%
pivot_longer(cols=contains("DSWP"),names_to = "maturity", values_to = "rate") %>%
arrange(maturity,observation_date) %>%
mutate(changes=(rate-lag(rate))*100) %>%
filter(maturity==lag(maturity)) %>%
mutate(date=observation_date,
maturity=substr(maturity,5,nchar(maturity)) %>% as.integer()) %>%
select(date,maturity,changes)
cov_matrix <- pca %>%
pivot_wider(names_from = "maturity", values_from = "changes")
cov_matrix <- cov_matrix[,2:ncol(cov_matrix)] %>%
select(`1`,`2`,`3`,`4`,`5`,`7`,`10`,`30`) %>%
cov() %>%
tibble()
cov_matrix
eigenstuff <- eigen(cov_matrix)
eigenstuff$ratio=eigenstuff$values/sum(eigenstuff$values)
eigenstuff$ratio
eigenstuff <- eigen(cov_matrix)
eigenstuff$ratio=eigenstuff$values/sum(eigenstuff$values)
eigenstuff
eigenstuff$ratio
eigenstuff$ratio*100
sum(eigenstuff$ratio[1:3]*100)
rm(list=ls())
library(tidyverse)
setwd("/Users/hwan/Desktop/Homepage/study_24spring")
getwd()
# problem1
ymd("20200415")-ymd("20200115")
50000000*0.0001*91/360/25
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614))
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614))
swap$rate[6]
N6=1000000/(swap$rate[6]*0.01+1)
swap$rate[5:]
swap$rate[5:length()]
swap$rate[5:6]
sum(swap$rate[5:6])
swap$rate[6]*0.01*N6
c(N5,N6)
N6=1000000/(swap$rate[6]*0.01+1)
N5=(1000000-swap$rate[6]*0.01*N6)/(swap$rate[5]*0.01+1)
swap$rate[5:6]*c(N5,N6)
sum(swap$rate[5:6]*c(N5,N6))
5:1
paste0("N",1) <- 1
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
result
for(i in 5:1){
result$par[i]=(1000000-sum(swap$rate[i+1:6]*result$par[i+1:6]))/(1+swap$rate[i])
}
result$par
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100)
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
for(i in 5:1){
result$par[i]=(1000000-sum(swap$rate[i+1:6]*result$par[i+1:6]))/(1+swap$rate[i])
}
result
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
result
i=5
result$par[i]=(1000000-sum(swap$rate[i+1:6]*result$par[i+1:6]))/(1+swap$rate[i])
result
swap$rate[i+1:6]
result$par[1:6-i]
result$par[1]
result$par[1:2]
result$par[1:1]
6-i
result$par[1:6-i]
1:6-i
1:(6-i)
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
for(i in 5:1){
result$par[i]=(1000000-sum(swap$rate[1:(6-i)]*result$par[1:(6-i)]))/(1+swap$rate[i])
}
result
result<- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
i=5
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
for(i in 5:1){
result$par[(5-i)]=(1000000-sum(swap$rate[1:(6-i)]*result$par[1:(6-i)]))/(1+swap$rate[i])
}
result
result <- tibble(tenor=c(6:1),
par=c(1000000/(swap$rate[6]+1),NA,NA,NA,NA,NA))
for(i in 5:1){
result$par[(7-i)]=(1000000-sum(swap$rate[1:(6-i)]*result$par[1:(6-i)]))/(1+swap$rate[i])
}
result
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100,
par=c(NA,NA,NA,NA,NA,c(1000000/(swap$rate[6]+1))))
swap
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100,
par=c(NA,NA,NA,NA,NA,c(1000000/(swap$rate[6]+1))))
for(i in 5:1){
result$par[i]=(1000000-sum(swap$rate[(i+1):6]*result$par[(i+1):6]))/(1+swap$rate[i])
}
result
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100,
par=c(NA,NA,NA,NA,NA,c(1000000/(swap$rate[6]+1))))
swap
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100,
par=c(NA,NA,NA,NA,NA,c(1000000/(swap$rate[6]+1))))
for(i in 5:1){
swap$par[i]=(1000000-sum(swap$rate[(i+1):6]*swap$par[(i+1):6]))/(1+swap$rate[i])
}
swap
# problem2
swap <- tibble(tenor=c(1:6),
rate=c(0.307,0.299,0.346,0.424,0.517,0.614)/100,
par=c(NA,NA,NA,NA,NA,c(1000000/(swap$rate[6]+1))))
for(i in 5:1){
swap$par[i]=(1000000-sum(swap$rate[(i+1):6]*swap$par[(i+1):6]))/(1+swap$rate[i])
}
swap
swap$par
View(swap)
swap$par[1]
swap$par[1] %>% round(4)
