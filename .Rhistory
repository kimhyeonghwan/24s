wp_A=0
wp_M=1-wp_A
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- optimal_pf %>%
mutate(w1=w0/sum(optimal_pf$w0))
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(optimal_pf$w1*optimal_pf$alpha)),
beta=c(1,sum(optimal_pf$w1*optimal_pf$beta)),
SD_residual=c(0,sum(optimal_pf$w1*(optimal_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA)
weight=c(wp_M,wp_A))
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(optimal_pf$w1*optimal_pf$alpha)),
beta=c(1,sum(optimal_pf$w1*optimal_pf$beta)),
SD_residual=c(0,sum(optimal_pf$w1*(optimal_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(wp_M,wp_A))
optimal_pf
w_A=0.5
w_M=1-w_A
optimal_pf$alpha[2]
optimal_pf$weight*optimal_pf$alpha
alpha_pf=sum(optimal_pf$weight*optimal_pf$alpha)
alpha_pf
optimal_pf$alpha
w_A=0.5
w_M=1-w_A
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(optimal_pf$w1*optimal_pf$alpha)),
beta=c(1,sum(optimal_pf$w1*optimal_pf$beta)),
SD_residual=c(0,sum(optimal_pf$w1*(optimal_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(w_M,w_A))
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(active_pf$w1*active_pf$alpha)),
beta=c(1,sum(active_pf$w1*active_pf$beta)),
SD_residual=c(0,sum(active_pf$w1*(active_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(w_M,w_A))
active_pf
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- optimal_pf %>%
mutate(w1=w0/sum(optimal_pf$w0))
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
alpha_pf=sum(optimal_pf$weight*optimal_pf$alpha)
alpha_pf
tmp <- summary(reg_cme)
tmp
tmp$sigma
tmp$coefficients
result_reg <- tibble(name=c("cme","ndaq","ice"),
alpha=c(reg_cme$coefficients[1],
reg_ndaq$coefficients[1],
reg_ice$coefficients[1]),
beta=c(reg_cme$coefficients[2],
reg_ndaq$coefficients[2],
reg_ice$coefficients[2]),
sd_residual=c(reg_cme$residuals %>% sd(),
reg_ndaq$residuals %>% sd(),
reg_ice$residuals %>% sd()))
result_reg
rm(list=ls())
setwd("/Users/hwan/Desktop/Homepage/study_24spring")
getwd()
library(tidyverse)
# stocks and market index S&P500 from yahoo finance
cme <- read_csv("investment_hw/cme.csv") %>% tibble()
ndaq <- read_csv("investment_hw/ndaq.csv") %>% tibble()
ice <- read_csv("investment_hw/ice.csv") %>% tibble()
spx <- read_csv("investment_hw/spx.csv") %>% tibble()
# risk-free rate is T-bill rate
tbill <- read_csv("investment_hw/tbill.csv") %>% tibble()
# set period 10years
strt_dd='20140101'
end_dd='20231231'
# tidy date
rfr <- tbill %>% mutate(tbill=`4 WEEKS BANK DISCOUNT`) %>%
mutate(y=paste0("20",substr(Date,nchar(Date)-1,nchar(Date)))) %>%
mutate(m=if_else(substr(Date,2,2)=="/",paste0("0",substr(Date,1,1)),substr(Date,1,2))) %>%
mutate(d=if_else(substr(Date,2,2)=="/",
if_else(substr(Date,4,4)=="/",paste0("0",substr(Date,3,3)),substr(Date,3,4)),
if_else(substr(Date,5,5)=="/",paste0("0",substr(Date,4,4)),substr(Date,4,5)))) %>%
mutate(day=paste0(y,m,d)) %>%
select(day,tbill)
raw_data <- tibble()
raw_data <- cme %>% mutate(cme=`Adj Close`) %>% select(Date,cme) %>%
left_join(ndaq %>% mutate(ndaq=`Adj Close`) %>% select(Date,ndaq)) %>%
left_join(ice %>% mutate(ice=`Adj Close`) %>% select(Date,ice)) %>%
left_join(spx %>% mutate(spx=`Adj Close`) %>% select(Date,spx)) %>%
mutate(day=gsub("-","",Date)) %>%
mutate(year=substr(day,1,4)) %>%
mutate(month=substr(day,1,6)) %>%
left_join(rfr,by="day") %>%
filter(day>=strt_dd,day<=end_dd) %>%
select(year,month,day,cme,ndaq,ice,spx,tbill,Date)
# using monthly return
monthly_raw <- tibble()
monthly_raw <- raw_data %>%
group_by(year,month) %>%
arrange(day %>% desc()) %>%
slice(1) %>%
pivot_longer(.,c("cme","ndaq","ice","spx"),
names_to = "name",values_to = "price") %>%
ungroup() %>%
arrange(name,year,month) %>%
mutate(return=price/lag(price)-1) %>%  # monthly return
mutate(ex_return=return-tbill/100/12) %>% # excess return
filter(as.integer(month)>=201901)
regression <- tibble()
regression <- monthly_raw %>%
select(day,name,ex_return) %>%
pivot_wider(.,values_from = "ex_return", names_from = "name")
reg_cme <- lm(regression$cme~regression$spx) %>% summary()
reg_ndaq <- lm(regression$ndaq~regression$spx) %>% summary()
reg_ice <- lm(regression$ice~regression$spx) %>% summary()
result_reg <- tibble(name=c("cme","ndaq","ice"),
alpha=c(reg_cme$coefficients[1],
reg_ndaq$coefficients[1],
reg_ice$coefficients[1]),
beta=c(reg_cme$coefficients[2],
reg_ndaq$coefficients[2],
reg_ice$coefficients[2]),
sd_residual=c(reg_cme$sigma,
reg_ndaq$sigma,
reg_ice$sigma))
reg_cme
reg_ndaq
reg_ice
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
result_reg
result_reg
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0))
w_A=0.5
w_M=1-w_A
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(active_pf$w1*active_pf$alpha)),
beta=c(1,sum(active_pf$w1*active_pf$beta)),
SD_residual=c(0,sum(active_pf$w1*(active_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(w_M,w_A))
alpha_pf=sum(optimal_pf$weight*optimal_pf$alpha)
beta_pf=sum(optimal_pf$weight*optimal_pf$beta)
SD_residual_pf=sum(optimal_pf$weight*optimal_pf$SD_residual^2) %>% sqrt()
alpha_pf=sum(optimal_pf$weight*optimal_pf$alpha)
beta_pf=sum(optimal_pf$weight*optimal_pf$beta)
SD_residual_pf=sum(optimal_pf$weight^2*optimal_pf$SD_residual^2) %>% sqrt()
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(active_pf$w1*active_pf$alpha)),
beta=c(1,sum(active_pf$w1*active_pf$beta)),
SD_residual=c(0,sum((active_pf$w1^2)*(active_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(w_M,w_A))
alpha_pf=sum(optimal_pf$weight*optimal_pf$alpha)
beta_pf=sum(optimal_pf$weight*optimal_pf$beta)
SD_residual_pf=sum(optimal_pf$weight^2*optimal_pf$SD_residual^2) %>% sqrt()
D_residual_pf
SD_residual_pf
optimal_pf
optimal_pf <- tibble(category=c("market","active"),
alpha=c(0,sum(active_pf$w1*active_pf$alpha)),
beta=c(1,sum(active_pf$w1*active_pf$beta)),
SD_residual=c(0,sum((active_pf$w1^2)*(active_pf$sd_residual^2)) %>% sqrt()),
SD=c(0.15,NA),
weight=c(w_M,w_A))
optimal_pf <- optimal_pf %>%
mutate(ex_return=c(0.06,alpha[2]+beta[2]*0.06))
optimal_pf
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
SR_pf=ex_return_pf/SD_pf
SR_pf
?optim
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weightA
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
return(excess_pf/SD_pf)
}
SR_pf=ex_return_pf/SD_pf
SR_pf
Sharpe_SIM(optimal_pf$alpha[2],optimal_pf$beta[2],optimal_pf$SD_residual[2],w_A,0.06,0.15)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
return(excess_pf/SD_pf)
}
Sharpe_SIM(optimal_pf$alpha[2],optimal_pf$beta[2],optimal_pf$SD_residual[2],w_A,0.06,0.15)
active_pf
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0)) %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf
optimal_pf
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0)) %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
w_A=0.5
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,w_A,0.06,0.15)
optim(w_A,Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,w_A,0.06,0.15))
optim(w_A,Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,,0.06,0.15))
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
return(excess_pf/SD_pf)
}
optim(w_A,Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,,0.06,0.15))
?optimize
optimize(Sharpe_SIM,c(0,1),maximum = TRUE)
optimize(Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,,0.06,0.15),c(0,1),maximum = TRUE)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
return(excess_pf/SD_pf)
}
optimize(Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,,0.06,0.15),c(0,1),maximum = TRUE)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
return(excess_pf/SD_pf)
}
optimize(Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,,0.06,0.15),c(0,1),maximum = TRUE)
maximize_SIM <- function(weight_A){Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,weight_A,0.06,0.15)}
optimize(maximize_SIM,c(0,1),maximum = TRUE)
maximize_SIM <- function(weight_A){Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,weight_A,0.06,0.15)}
maximize_SIM()
maximize_SIM(0.5)
optimize(maximize_SIM,c(0,1),maximum = TRUE)
active_pf
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0))
active_pf
active_pf %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0))
active_pf %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf
active_pf
active_pf %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0))
active_pf
active_pf <- active_pf %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf
optimize(maximize_SIM,c(0,1),maximum = TRUE)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
result <- tibble(alpha=alpha_pf,
beta=beta_pf,
excess_return=excess_pf,
SD=SD_pf
Sharpe=excess_pf/SD_pf)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
result <- tibble(alpha=alpha_pf,
beta=beta_pf,
excess_return=excess_pf,
SD=SD_pf
Sharpe=excess_pf/SD_pf)
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
result <- tibble(alpha=alpha_pf,
beta=beta_pf,
excess_return=excess_pf,
SD=SD_pf,
Sharpe=excess_pf/SD_pf)
return(result)
}
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
result <- tibble(alpha=alpha_pf,
beta=beta_pf,
excess_return=excess_pf,
SD=SD_pf,
Sharpe=excess_pf/SD_pf)
return(result)
}
maximize_SIM <- function(weight_A){
result <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,weight_A,0.06,0.15)
return(result$Sharpe)}
optimize(maximize_SIM,c(0,1),maximum = TRUE)
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)
optimal_weight
optimal_weight$objective
optimize(maximize_SIM,c(0,1),maximum = TRUE)[1]
optimize(maximize_SIM,c(0,1),maximum = TRUE)$objective
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$objective
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,optimal_weight,0.06,0.15)
o
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$objective
optimal_weight
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,optimal_weight,0.06,0.15)
optimal_weight
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,0.5,0.06,0.15)
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,0.4,0.06,0.15)
optimize(maximize_SIM,c(0,1),maximum = TRUE)
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,0.8969,0.06,0.15)
Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,optimal_weight,0.06,0.15)
active_pf
info_ratio=active_pf$alpha/active_pf$sd_residual
info_ratio
SIM_optimal <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,optimal_weight,0.06,0.15)
# problem (e)
SIM_optimal
# problem (e)
SIM_optimal$Sharpe
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$maximum
optimal_weight
SIM_optimal <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,optimal_weight,0.06,0.15)
SIM_optimal
# problem (e)
SIM_optimal$Sharpe
0.06/0.15
0.06/12
0.15/sqrt(12)
source("~/Desktop/hwan/r/hwan/investment4.R", echo=TRUE)
SIM_optimal
info_ratio=active_pf$alpha/active_pf$sd_residual
info_ratio
0.005/0.15/sqrt(12)
0.005/(0.15/sqrt(12))
(0.15/sqrt(12))
0.005/(0.15/sqrt(12))
rm(list=ls())
setwd("/Users/hwan/Desktop/Homepage/study_24spring")
getwd()
library(tidyverse)
# stocks and market index S&P500 from yahoo finance
cme <- read_csv("investment_hw/cme.csv") %>% tibble()
ndaq <- read_csv("investment_hw/ndaq.csv") %>% tibble()
ice <- read_csv("investment_hw/ice.csv") %>% tibble()
spx <- read_csv("investment_hw/spx.csv") %>% tibble()
# risk-free rate is T-bill rate
tbill <- read_csv("investment_hw/tbill.csv") %>% tibble()
# set period 10years
strt_dd='20140101'
end_dd='20231231'
# tidy date
rfr <- tbill %>% mutate(tbill=`4 WEEKS BANK DISCOUNT`) %>%
mutate(y=paste0("20",substr(Date,nchar(Date)-1,nchar(Date)))) %>%
mutate(m=if_else(substr(Date,2,2)=="/",paste0("0",substr(Date,1,1)),substr(Date,1,2))) %>%
mutate(d=if_else(substr(Date,2,2)=="/",
if_else(substr(Date,4,4)=="/",paste0("0",substr(Date,3,3)),substr(Date,3,4)),
if_else(substr(Date,5,5)=="/",paste0("0",substr(Date,4,4)),substr(Date,4,5)))) %>%
mutate(day=paste0(y,m,d)) %>%
select(day,tbill)
raw_data <- tibble()
raw_data <- cme %>% mutate(cme=`Adj Close`) %>% select(Date,cme) %>%
left_join(ndaq %>% mutate(ndaq=`Adj Close`) %>% select(Date,ndaq)) %>%
left_join(ice %>% mutate(ice=`Adj Close`) %>% select(Date,ice)) %>%
left_join(spx %>% mutate(spx=`Adj Close`) %>% select(Date,spx)) %>%
mutate(day=gsub("-","",Date)) %>%
mutate(year=substr(day,1,4)) %>%
mutate(month=substr(day,1,6)) %>%
left_join(rfr,by="day") %>%
filter(day>=strt_dd,day<=end_dd) %>%
select(year,month,day,cme,ndaq,ice,spx,tbill,Date)
# using monthly return
monthly_raw <- tibble()
monthly_raw <- raw_data %>%
group_by(year,month) %>%
arrange(day %>% desc()) %>%
slice(1) %>%
pivot_longer(.,c("cme","ndaq","ice","spx"),
names_to = "name",values_to = "price") %>%
ungroup() %>%
arrange(name,year,month) %>%
mutate(return=price/lag(price)-1) %>%  # monthly return
mutate(ex_return=return-tbill/100/12) %>% # excess return
filter(as.integer(month)>=201901)
# problem (b)
regression <- tibble()
regression <- monthly_raw %>%
select(day,name,ex_return) %>%
pivot_wider(.,values_from = "ex_return", names_from = "name")
reg_cme <- lm(regression$cme~regression$spx) %>% summary()
reg_ndaq <- lm(regression$ndaq~regression$spx) %>% summary()
reg_ice <- lm(regression$ice~regression$spx) %>% summary()
result_reg <- tibble(name=c("cme","ndaq","ice"),
alpha=c(reg_cme$coefficients[1],
reg_ndaq$coefficients[1],
reg_ice$coefficients[1]),
beta=c(reg_cme$coefficients[2],
reg_ndaq$coefficients[2],
reg_ice$coefficients[2]),
sd_residual=c(reg_cme$sigma,
reg_ndaq$sigma,
reg_ice$sigma))
reg_cme
reg_ndaq
reg_ice
# problem (c)
active_pf <- result_reg %>%
mutate(w0=alpha/sd_residual^2)
active_pf <- active_pf %>%
mutate(w1=w0/sum(active_pf$w0))
active_pf
active_pf <- active_pf %>%
summarise(alpha=sum(w1*alpha),
beta=sum(w1*beta),
sd_residual=sum(w1^2*sd_residual^2) %>% sqrt())
active_pf
Sharpe_SIM <- function(alpha_A,beta_A,SD_residual_A,weight_A=0.5,excess_M,SD_M){
alpha_pf=weight_A*alpha_A
beta_pf=weight_A*beta_A+1-weight_A
excess_pf=alpha_pf+beta_pf*excess_M
Var_residual_pf=weight_A^2*SD_residual_A^2
SD_pf=sqrt(beta_pf^2*SD_M^2+Var_residual_pf)
result <- tibble(alpha=alpha_pf,
beta=beta_pf,
excess_return=excess_pf,
SD=SD_pf,
Sharpe=excess_pf/SD_pf)
return(result)
}
maximize_SIM <- function(weight_A){
result <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,
weight_A,0.06/12,0.15/sqrt(12))
return(result$Sharpe)}
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$maximum
SIM_optimal <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,
optimal_weight,0.06/12,0.15/sqrt(12))
info_ratio=active_pf$alpha/active_pf$sd_residual
info_ratio
SIM_optimal
optimal_weight
maximize_SIM <- function(weight_A){
result <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,
weight_A,0.06,0.15)
return(result$Sharpe)}
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$maximum
optimal_weight
maximize_SIM <- function(weight_A){
result <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,
weight_A,0.06/12,0.15/sqrt(12))
return(result$Sharpe)}
optimal_weight=optimize(maximize_SIM,c(0,1),maximum = TRUE)$maximum
optimal_weight
SIM_optimal <- Sharpe_SIM(active_pf$alpha,active_pf$beta,active_pf$sd_residual,
optimal_weight,0.06/12,0.15/sqrt(12))
SIM_optimal
info_ratio=active_pf$alpha/active_pf$sd_residual
info_ratio
# problem (e)
SIM_optimal$Sharpe
0.005/(0.15/sqrt(12))
# problem (e)
SIM_optimal$Sharpe
0.005/(0.15/sqrt(12))
